@{
    ViewData["Title"] = "Main Page";
    var questionlist = (List<Question>)ViewData["ListofQuestion"];
    List<int> QuestionStatus = (List<int>)ViewData["ListOfQuestionStatus"];
    var UserId = ViewData["CurrentUserId"];
    var Name = ViewData["Name"];
    var username = ViewData["Username"];
}
@section links{
    <link rel="stylesheet" href="@Url.Content("~/css/MainPage.css?version=1")">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
}
<div class="container" id="question">
    <div class="headofquestion">
        <h1>Top Questions</h1>
        <hr>
    </div>
    <div class="questions">
        @for (int i = 0; i < questionlist.Count; i++)
        {
@*            <form asp-action="CheckQuestionUpvoteStatus" style="display:inline">
                <input name="QuestionId" value="@questionlist[i].Id" style="display:none"/>
                <input name="UserId" value="@UserId" style="display:none"/>
            </form>*@
        <partial name="~/Views/Question/_Partial.cshtml" view-data='@new ViewDataDictionary(ViewData) {{"question",questionlist[i]},{"index",i},{"questionstatus",QuestionStatus[i]}}'/>
        }
    </div>
    <a asp-controller="Question" asp-action="LoadMore">Load More</a>
</div>
<script>
var collection = document.getElementsByClassName("like-btn");
var collection1 = document.getElementsByClassName("dislike-btn");
for (let i = 0; i < collection.length; i++) {
    collection[i].onclick = function () {
        if (collection[i].style.backgroundColor !=(0, 0, 255))
    {
            collection[i].style.backgroundColor = "rgb(0,0,255)";
            collection[i].style.color="rgb(255,255,255)"
            collection1[i].disabled = true;
    }
    else
    {
            collection[i].style.backgroundColor = "rgb(0,0,0)";
            collection[i].style.color = "rgb(0,0,255)"
            collection1[i].disabled = false;
    }  
  }
}
for (let i = 0; i < collection1.length; i++) {
  collection1[i].onclick=function(){
      if (collection1[i].style.backgroundColor !="rgb(139, 0, 0)")
    {
          collection1[i].style.backgroundColor = "rgb(139,0,0)";
          collection1[i].style.color = "rgb(255,255,255)"
          collection[i].disabled = true;
    }
    else
    {
          collection1[i].style.backgroundColor = "rgb(255,255,255)";
          collection1[i].style.color = "rgb(139,0,0)"
          collection[i].disabled = false;
    }  
  }
}
$(document).ready(function(){
    document.addEventListener("click", function(e) {
        e = e.target;
        if(e.classList.contains("search-btn"))
        {
            var data1 = new FormData();
            data1.append("searchvalue", $("#search").val());
            data1.append("Category", $("#category").val());
            $.ajax({
                method:"post",
                url:"/Question/SearchQuestion",
                data:data1,
                contentType: false,
                processData:false,
                success: function(data) {
                    data = JSON.parse(data);
                    console.log(data);
                    var row = document.getElementById("question");
                    console.log(row);
                    if(data.length==0)
                    {
                        row.innerHTML = "";
                    }
                    for (let i = 0; i < data.length; i++) {
                    var movieNode = document.getElementsByClassName("question-item")[0].cloneNode(true);
                    if(i==0)
                    {
                        row.innerHTML = "";
                    }
                    movieNode.children[0].children[0].innerHTML=data[i].Title;
                    $(movieNode.children[0].children[3].children[0]).attr("value",data[i].Id)
                    $(movieNode.children[0].children[4].children[0]).attr("value",data[i].Id)
                    movieNode.children[0].children[6].innerHTML=data[i].Upvote
                    console.log(movieNode.children[0].children[6]);
                    var date1 = new Date(data[i].Time)
                    movieNode.children[1].children[0].innerHTML = date1.toLocaleString();
                    movieNode.children[1].children[1].children[1].innerHTML = data[i].QuestionaireName;
                    console.log(movieNode.children[1].children[1].children[1]);
                    $(movieNode.children[0].children[1].children[2]).attr("disabled", "disabled");
                    $(movieNode.children[0].children[2].children[2]).attr("disabled", "disabled");
                    $(movieNode.children[0].children[1].children[2]).css("background-color","white");
                    $(movieNode.children[0].children[1].children[2]).css("color", "darkblue");
                    row.appendChild(movieNode);
                    }
                },
                error: function() {
                    console.log("error");
                }
            })
            console.log("Clicked");
        }
    })
})
</script>